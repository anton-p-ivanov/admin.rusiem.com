"use strict";(self.webpackChunkadmin_rusiem_com=self.webpackChunkadmin_rusiem_com||[]).push([[270],{2723:(e,t,r)=>{r.d(t,{Z:()=>k});var n=r(4942),o=r(7294),c=r(3884),a=r(7390),i=r(8776);function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var u=r(7697),f=r(325);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d=r(3379),b=r.n(d),O=r(7795),v=r.n(O),y=r(569),g=r.n(y),j=r(3565),E=r.n(j),w=r(9216),h=r.n(w),P=r(4589),D=r.n(P),Z=r(8363),C={};function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}C.styleTagTransform=D(),C.setAttributes=E(),C.insert=g().bind(null,"head"),C.domAPI=v(),C.insertStyleElement=h(),b()(Z.Z,C),Z.Z&&Z.Z.locals&&Z.Z.locals;const k=function(e){var t=e.description,r=e.endpoint,n=(0,o.useContext)(a._),s=n.state,p=n.update,d=function(){var e=(0,f.o)().refresh,t=(0,o.useContext)(a._),r=t.state,n=t.update,c=(0,o.useContext)(i._).toggle;return{dismiss:function(){return c&&c(!1)},confirm:function(){var t={method:"DELETE",url:r.endpoint,data:{password:r.password}};u.Z.request(t).then((function(t){200===t.status?(e(),"function"==typeof c&&c(!1)):n(m(m({},r),{},{errors:{password:["Could not delete a row"]}}))})).catch((function(e){var t;n(m(m({},r),{},{errors:null===(t=e.response)||void 0===t?void 0:t.data}))}))}}}(),b=function(){var e,t=(0,o.useRef)(null),r=(0,o.useContext)(a._),n=r.state,c=r.update,s=(0,o.useContext)(i._).isVisible,u={ref:t,name:"password",label:"Введите пароль для подтверждения действия",type:"password",value:n.password||"",errors:null===(e=n.errors)||void 0===e?void 0:e.password,onChange:function(e){c(l(l({},n),{},{errors:{},password:e}))}};return(0,o.useEffect)((function(){s&&t.current&&(t.current.focus(),c(l(l({},n),{},{password:""})))}),[s]),{password:u}}();(0,o.useEffect)((function(){return p(S(S({},s),{},{description:t,endpoint:r}))}),[r]);var O=!s.password||0===s.password.length;return o.createElement(c.u_,{title:"Требуется подтверждение",size:"small"},o.createElement("div",{className:"confirm-view"},o.createElement("div",{className:"confirm-view__description"},t),o.createElement("div",{className:"confirm-view__form"},o.createElement(c.l0.Field,{field:b.password}),o.createElement(c.l0.Actions,null,o.createElement(c.zx,{onClick:d.confirm,isDisabled:O,variant:"danger"},"Подтвердить"),o.createElement(c.zx,{onClick:d.dismiss},"Отменить")))))}},1394:(e,t,r)=>{r.d(t,{_y:()=>s,ZP:()=>v,Jt:()=>u.Z});var n=r(4942),o=r(7294),c=r(4184),a=r.n(c),i=r(3884);const s=o.createContext({fields:{}});var l=r(885),u=r(4393);function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const m=function(e){var t=(0,u.o)(),r=t.state,o=t.update,c=Object.entries(e).map((function(e){var t=(0,l.Z)(e,2),c=t[0],a=t[1],i=r.data[a.name],s={value:null==i?a.emptyValue||"":i,errors:r.errors[a.name],onChange:function(e){o(p(p({},r),{},{data:p(p({},r.data),{},(0,n.Z)({},a.name,e))}))}};return[c,p(p({},a),s)]}));return Object.fromEntries(c)};var d=r(6974);function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const v=function(e){var t=(0,o.useRef)(null),r=e.fields,n=e.defaults,c=void 0===n?{}:n,l=e.variant,f=e.endpoints,p=e.children,b=(0,u.o)(),v=function(e){var t=e.endpoints,r=e.onSubmit,n=e.onSubmitSucceed,o=(0,u.o)(),c=(0,d.s0)();return{submit:function(e){e.preventDefault(),"function"==typeof r?r(e):null!=t&&t.submit&&o.submit(t.submit,o.state.data).then((function(e){return"function"==typeof n?n(e):void c((null==t?void 0:t.success)||"/")})).catch((function(e){return e}))}}}(e);(0,o.useEffect)((function(){return b.update(O(O({},b.state),{},{data:c})),f&&f.request&&b.request(f.request),function(){return b.reset()}}),[]);var y=a()("form-view",l&&"form-view--".concat(l)),g="VALIDATION_FAILED"===b.state.status,j="SUBMIT_FAILED"===b.state.status,E="SUBMIT_SUCCEED"===b.state.status;return(0,o.useEffect)((function(){(j||E||g)&&t.current&&t.current.scrollIntoView({behavior:"smooth"})}),[E,j,g]),o.createElement(s.Provider,{value:{fields:m(r||{})}},o.createElement("div",{ref:t},o.createElement(i.bZ,{variant:"danger",isVisible:j},"Ошибка сохранения изменений. Пожалуйста, попробуйте позже."),o.createElement(i.bZ,{variant:"warning",isVisible:g},"Вероятно, некоторые поля формы заполнены неверно"),o.createElement(i.bZ,{variant:"success",isVisible:E},"Изменения успешно сохранены")),o.createElement("div",{className:y},o.createElement(i.l0,{onSubmit:v.submit},p)))}},9466:(e,t,r)=>{r.d(t,{Z:()=>P});var n=r(4942),o=r(7294),c=r(5823),a=r(325);const i={sortBy:{name:"sortBy",type:"select"},sortOrder:{name:"sortOrder",type:"select",attrs:{options:[{value:"ASC",label:"По возр."},{value:"DESC",label:"По убыв."}]}}};var s=r(3379),l=r.n(s),u=r(7795),f=r.n(u),p=r(569),m=r.n(p),d=r(3565),b=r.n(d),O=r(9216),v=r.n(O),y=r(4589),g=r.n(y),j=r(4019),E={};function w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?w(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}E.styleTagTransform=g(),E.setAttributes=b(),E.insert=m().bind(null,"head"),E.domAPI=f(),E.insertStyleElement=v(),l()(j.Z,E),j.Z&&j.Z.locals&&j.Z.locals;const P=function(e){var t=e.columns,r=(0,a.o)(),s=r.state,l=r.update;return Object.keys(i).forEach((function(e){var t=i[e],r={value:s.sort?s.sort[e]:"",onChange:function(t){l(h(h({},s),{},{sort:s.sort?h(h({},s.sort),{},(0,n.Z)({},e,t)):(0,n.Z)({},e,t),timestamp:(new Date).getTime()}))}};i[e]=h(h({},t),r)})),i.sortBy.attrs={options:t.filter((function(e){return e.title})).map((function(e){return{value:e.name,label:e.title}}))},o.createElement("div",{className:"list-view__sort"},o.createElement(c.Z,{variant:"sort"},o.createElement(c.Z.Field,{field:i.sortBy}),o.createElement(c.Z.Field,{field:i.sortOrder})))}},7882:(e,t,r)=>{r.d(t,{BK:()=>i,N2:()=>k,Js:()=>I});var n=r(7294),o=r(3884),c=r(8776);const a=n.createContext({remove:function(){return null}}),i=function(e){var t=e.data,r=e.baseUrl,i=e.children,s=t.uuid,l=void 0===s?"unknown":s,u=t.title,f=(0,n.useContext)(c._).toggle,p=n.createElement(o.JO,{name:"more-vertical",title:"Выберите действие"});return n.createElement(a.Provider,{value:{remove:function(){return f&&f(!0,{description:'Вы собираетесь удалить элемент "'.concat(u,'".'),endpoint:"".concat(r,"/").concat(l)})}}},n.createElement(o.vb,{toggle:p},n.createElement(a.Consumer,null,i||function(e){return n.createElement(n.Fragment,null,n.createElement(o.vb.Link,{icon:"edit",route:"".concat(r,"/").concat(l,"/edit")},"Изменить"),n.createElement(o.vb.Link,{icon:"copy",route:"".concat(r,"/").concat(l,"/copy")},"Копировать"),n.createElement(o.vb.Divider,null),n.createElement(o.vb.Button,{icon:"trash-2",onClick:e.remove},"Удалить"))})))};var s=r(1394),l=r(4942),u=r(7697),f=r(4393),p=r(325),m=r(3150);function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){(0,l.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var O=r(3379),v=r.n(O),y=r(7795),g=r.n(y),j=r(569),E=r.n(j),w=r(3565),h=r.n(w),P=r(9216),D=r.n(P),Z=r(4589),C=r.n(Z),_=r(5068),S={};S.styleTagTransform=C(),S.setAttributes=h(),S.insert=E().bind(null,"head"),S.domAPI=g(),S.insertStyleElement=D(),v()(_.Z,S),_.Z&&_.Z.locals&&_.Z.locals;const k=(0,s.Jt)((function(e){var t=e.param,r=e.fields,c=e.children,a=function(e){var t=(0,f.o)(),r=(0,p.o)(),o=(0,n.useContext)(m.Z).toggle,c=function(n){var c={url:"/user/params",method:n,data:{param:e,value:t.state.data}};u.Z.request(c).then((function(){o&&o(),"DELETE"===n&&t.reset(),r.refresh()})).catch((function(){return t.reset()}))};return{apply:function(){c("PATCH")},reset:function(){c("DELETE")},fetch:function(){u.Z.request({url:"/user/params",method:"GET"}).then((function(r){if(e in r.data){var n=r.data[e].value;t.update(b(b({},t.state),{},{data:n}))}})).catch((function(){return t.reset()}))}}}(t);return(0,n.useEffect)((function(){return a.fetch()}),[]),n.createElement("div",{className:"list-view__filter"},n.createElement(s.ZP,{fields:r},n.createElement("div",{className:"form__fields"},n.createElement(s._y.Consumer,null,c||function(e){return n.createElement(n.Fragment,null,n.createElement(o.l0.Field,{field:e.fields.title}),n.createElement(o.l0.Field,{field:e.fields.publishedAt}),n.createElement(o.l0.Field,{field:e.fields.site}),n.createElement(o.l0.Field,{field:e.fields.locale}),n.createElement(o.l0.Field,{field:e.fields.isPublished}))})),n.createElement(o.l0.Actions,null,n.createElement(o.zx,{onClick:a.apply,variant:"primary"},"Применить"),n.createElement(o.zx,{onClick:a.reset},"Сбросить"))))}));r(9466);var x=r(9711);const I=function(e){var t=(0,n.useContext)(m.Z).toggle,r=(0,p.o)().refresh,c=e.createUrl,a=e.createLabel,i=void 0===a?"Добавить":a,s=e.withFilter,l=void 0===s||s,u=e.children;return n.createElement(o.kR,null,n.createElement(o.kR.Group,null,c&&n.createElement(o.kR.Item,null,n.createElement(x.rU,{to:c,className:"btn btn--success"},i)),n.createElement(o.kR.Item,null,n.createElement(o.zx,{onClick:function(e){e.preventDefault(),r()}},n.createElement(o.JO,{name:"refresh-cw",title:"Обновить"})))),n.createElement(o.kR.Group,null,n.createElement(o.kR.Item,null,u),l&&n.createElement(o.kR.Item,null,n.createElement(o.zx,{onClick:function(e){return e.preventDefault(),t&&t()}},n.createElement(o.JO,{name:"filter",title:"Параметры фильтрации"})))))}},325:(e,t,r)=>{r.d(t,{Z:()=>g,o:()=>y});var n=r(7294),o=r(4942),c=r(885);const a={API:r(7697).Z,className:function(e){return e.filter((function(e){return e})).join(" ").trim()}};var i=function(e){return{type:1,payload:e}};function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){(0,o.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var u={status:"WAITING",data:[],pagination:{page:1,size:20,total:0},isFiltered:!1,timestamp:(new Date).getTime()};const f=function(e,t){var r=t.payload;switch(t.type){case 0:return l(l({},e),u);case 1:return l(l({},e),r);case 2:return l(l({},e),{},{status:"FETCHING"});case 3:return l(l({},e),{},{status:"FETCH_SUCCEED"},r);case 4:return l(l({},e),{},{status:"FETCH_FAILED"});default:return e}};function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){(0,o.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){(0,o.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const O=function(e){var t=n.useReducer(f,e||u),r=(0,c.Z)(t,2),o=r[0],s=r[1],l=function(e,t){return{requestSucceed:function(r){var n={total:parseInt(r.headers["x-pagination-total"],10),size:parseInt(r.headers["x-pagination-size"],10),page:parseInt(r.headers["x-pagination-page"],10)},o="1"===r.headers["x-results-filtered"];t({type:3,payload:m(m({},e),{},{data:r.data,pagination:n,isFiltered:o})})},requestFailed:function(){t({type:4})}}}(o,s),p=l.requestSucceed,d=l.requestFailed;return{state:o,update:function(e){s(i(e))},refresh:function(){s(i(b(b({},o),{},{timestamp:(new Date).getTime()})))},request:function(e){s({type:2});var t={page:e.page.toString(),size:e.size.toString()};o.sort&&(t.sort=("DESC"===o.sort.sortOrder?"-":"")+o.sort.sortBy);var r="https://api.ivanov-ap.ru".replace(/\/$/,""),n=new URL("".concat(r).concat(e.endpoint));Object.keys(t).forEach((function(e){n.searchParams.append(e,t[e])}));var c={method:"GET",url:n.href};a.API.request(c).then(p).catch(d)}}},v=n.createContext({state:u,update:function(){return null},refresh:function(){return null},request:function(){return null}});var y=function(){return(0,n.useContext)(v)};const g=function(e){var t=function(t){return n.createElement(v.Provider,{value:O()},n.createElement(e,t))};return t.displayName=e.displayName||e.name||"Component",t}},7390:(e,t,r)=>{r.d(t,{_:()=>a,Z:()=>i});var n=r(885),o=r(7294),c={isValid:!0};const a=o.createContext({state:c,update:function(){return!1}}),i=function(e){var t=function(t){var r=(0,o.useState)(c),i=(0,n.Z)(r,2),s=i[0],l=i[1];return o.createElement(a.Provider,{value:{state:s,update:l}},o.createElement(e,t))};return t.displayName=e.displayName||e.name||"Component",t}},8776:(e,t,r)=>{r.d(t,{_:()=>c,Z:()=>a});var n=r(885),o=r(7294);const c=o.createContext({isVisible:!1}),a=function(e,t){var r=function(r){var a=(0,o.useState)(!1),i=(0,n.Z)(a,2),s=i[0],l=i[1],u=(0,o.useState)({}),f=(0,n.Z)(u,2),p=f[0],m=f[1];return o.createElement(c.Provider,{value:{toggle:function(e,t){l(void 0!==e?e:!s),void 0!==t&&m(t)},isVisible:s}},o.createElement(e,r),s&&o.createElement(t,p))};return r.displayName=e.displayName||e.name||"Component",r}},3150:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r(7294).createContext({})},8363:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(8081),o=r.n(n),c=r(3645),a=r.n(c)()(o());a.push([e.id,".confirm-view__description{margin-bottom:2rem}",""]);const i=a},5068:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(8081),o=r.n(n),c=r(3645),a=r.n(c)()(o());a.push([e.id,".list-view__filter{height:100%}.list-view__filter .form-view{height:100%}.list-view__filter .form-view .form{height:100%;display:flex;flex-direction:column;justify-content:space-between}",""]);const i=a},4019:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(8081),o=r.n(n),c=r(3645),a=r.n(c)()(o());a.push([e.id,".list-view__sort .form.form--sort{display:flex;align-content:center;align-items:center;justify-content:flex-end;flex-direction:row}.list-view__sort .form.form--sort *{margin-bottom:0}.list-view__sort .form.form--sort *~*{margin-left:.25rem}",""]);const i=a}}]);