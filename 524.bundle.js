"use strict";(self.webpackChunkadmin_rusiem_com=self.webpackChunkadmin_rusiem_com||[]).push([[524],{3524:(e,t,r)=>{r.d(t,{Z:()=>I});var n=r(7294),a=r(6974),l=r(8594),i=r(3884),c=r(885),o=r(4184),s=r.n(o),u=r(7697),m=r(4942),d=r(4393);function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){(0,m.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var v=r(3379),b=r.n(v),w=r(7795),E=r.n(w),g=r(569),y=r.n(g),_=r(3565),O=r.n(_),h=r(9216),Z=r.n(h),j=r(4589),k=r.n(j),P=r(4727),S={};S.styleTagTransform=k(),S.setAttributes=O(),S.insert=y().bind(null,"head"),S.domAPI=E(),S.insertStyleElement=Z(),b()(P.Z,S),P.Z&&P.Z.locals&&P.Z.locals;const x=function(e){var t=e.fields,r=e.template,a=(0,n.useState)([]),l=(0,c.Z)(a,2),o=l[0],f=l[1],v=(0,n.useState)("ru"),b=(0,c.Z)(v,2),w=b[0],E=b[1],g=function(e,t){var r=(0,d.o)(),n=r.state,a=r.update;return Object.fromEntries(e.map((function(e){var r=Object.entries(t).map((function(t){var r=(0,c.Z)(t,2),l=r[0],i=r[1],o=n.data,s=o.translations&&o.translations[e.value],u={value:s&&s[i.name]||"",onChange:function(t){var r=p(p({},s),{},(0,m.Z)({locale:e.value},l,t)),i=p(p({},o.translations||{}),{},(0,m.Z)({},e.value,r));a(p(p({},n),{},{data:p(p({},n.data),{},{translations:i})}))}};return[l,p(p({},i),u)]}));return[e.value,Object.fromEntries(r)]})))}(o,t),y={type:"select",name:"switch",label:"Язык",attrs:{options:o},value:w,onChange:function(e){return E(e)}};return(0,n.useEffect)((function(){return u.Z.lookup("/locales/lookup").then((function(e){return f(e)})).catch((function(){return f([])})),function(){return f([])}}),[]),n.createElement("div",{className:"locale-view"},n.createElement("div",{className:"locale-view__switch"},n.createElement(i.l0.Field,{field:y})),n.createElement("div",{className:"locale-view__content"},o.map((function(e){var t=s()("locale-view__pane",e.value===w&&"locale-view__pane--active");return n.createElement("div",{className:t,key:"locale-view-pane-".concat(e.value)},r?r(g[e.value]):Object.entries(g[e.value]).map((function(t){var r=(0,c.Z)(t,2),a=r[0],l=r[1];return n.createElement(i.l0.Field,{field:l,key:"locale-view-".concat(e.value,"-").concat(a)})})))}))))},N=function(e){var t=e.fields,r={subject:t.subject,text:t.text,html:t.html},a=[{value:"text",label:"Текст"},{value:"html",label:"HTML"}];return n.createElement("div",{className:"grid-view__left-pane"},n.createElement(i.l0.Group,null,n.createElement("div",{className:"grid-view__columns"},n.createElement(i.l0.Field,{field:t.sender}),n.createElement(i.l0.Field,{field:t.recipient})),n.createElement(i.l0.Field,{field:t.code})),n.createElement(i.l0.Group,null,n.createElement(x,{fields:r,template:function(e){return n.createElement("div",{className:"locale-fields"},n.createElement(i.l0.Field,{field:e.subject}),n.createElement(i.mQ,{variant:"t10n",items:a.map((function(t){return{label:t.label,component:n.createElement(i.l0.Field,{field:e[t.value]})}}))}))}})))},A=function(e){var t=e.fields;return n.createElement("div",{className:"grid-view__right-pane"},n.createElement(i.l0.Field,{field:t.extraHeaders}),n.createElement(i.l0.Field,{field:t.attachment}))},D={translations:{},code:"",recipient:"",sender:""},T={code:{name:"code",label:"Уникальный символьный код шаблона",hint:"Допускается не более 250 символов [a-z0-9-_]"},sender:{name:"sender",label:"Отправитель",hint:"Укажите E-Mail отправителя"},recipient:{name:"recipient",label:"Получатель",hint:"Укажите E-Mail получателя"},attachment:{type:"file",name:"attachment",label:"Вложение",hint:"Выберите файл, который будет прикреплен к письму"},extraHeaders:{type:"textarea",name:"extraHeaders",label:"Дополнительные заголовки",hint:"Дополнительные параметры письма в формате JSON",attrs:{size:"small"}},subject:{name:"subject",label:"Тема письма",hint:"Допускается не более 250 символов."},html:{name:"html",type:"textarea",attrs:{size:"large"}},text:{name:"text",type:"textarea",attrs:{size:"large"}}};var F=r(7590),C={};C.styleTagTransform=k(),C.setAttributes=O(),C.insert=y().bind(null,"head"),C.domAPI=E(),C.insertStyleElement=Z(),b()(F.Z,C),F.Z&&F.Z.locals&&F.Z.locals;const I=function(e){var t=e.isNewElement,r=void 0!==t&&t,i=(0,a.UO)().uuid,c={request:i&&"GET:/mail/templates/".concat(i),submit:r?"POST:/mail/templates":i&&"PUT:/mail/templates/".concat(i),success:"/mail/templates"};return n.createElement(l.Z,{endpoints:c,fields:T,defaults:D},(function(e){return n.createElement(n.Fragment,null,n.createElement(N,{fields:e.fields}),n.createElement(A,{fields:e.fields}))}))}},8594:(e,t,r)=>{r.d(t,{Z:()=>A});var n=r(885),a=r(4925),l=r(7294),i=r(9711),c=r(6974),o=r(3884),s=r(1394),u=r(4393);const m=function(e){var t=e.workflow,r=e.defaults;return l.createElement(l.Fragment,null,l.createElement("span",null,"Создано ",t&&t.createdBy||(null==r?void 0:r.name)),l.createElement("span",null,t&&t.createdAt?l.createElement(o.ZX,{format:"datetime",value:t.createdAt}):null==r?void 0:r.date))},d=function(e){var t=e.workflow,r=e.defaults;return l.createElement(l.Fragment,null,l.createElement("span",null,"Изменено ",t&&t.updatedBy||(null==r?void 0:r.name)),l.createElement("span",null,t&&t.updatedAt?l.createElement(o.ZX,{format:"datetime",value:t.updatedAt}):null==r?void 0:r.date))};var f=r(3379),p=r.n(f),v=r(7795),b=r.n(v),w=r(569),E=r.n(w),g=r(3565),y=r.n(g),_=r(9216),O=r.n(_),h=r(4589),Z=r.n(h),j=r(3135),k={};k.styleTagTransform=Z(),k.setAttributes=y(),k.insert=E().bind(null,"head"),k.domAPI=b(),k.insertStyleElement=O(),p()(j.Z,k),j.Z&&j.Z.locals&&j.Z.locals;const P=function(){var e=(0,u.o)().state.data.workflow,t={name:"Джон Смит",date:"Дата неизвестна"};return l.createElement("div",{className:"workflow-view"},l.createElement("div",{className:"workflow-view__item workflow-view__item--created"},l.createElement("div",{className:"workflow-view__icon"},l.createElement(o.JO,{name:"clock"})),l.createElement("div",{className:"workflow-view__text"},l.createElement(m,{workflow:e,defaults:t}))),l.createElement("div",{className:"workflow-view__item workflow-view__item--updated"},l.createElement("div",{className:"workflow-view__icon"},l.createElement(o.JO,{name:"clock"})),l.createElement("div",{className:"workflow-view__text"},l.createElement(d,{workflow:e,defaults:t}))))};var S=r(4752),x={};x.styleTagTransform=Z(),x.setAttributes=y(),x.insert=E().bind(null,"head"),x.domAPI=b(),x.insertStyleElement=O(),p()(S.Z,x),S.Z&&S.Z.locals&&S.Z.locals;var N=["children"];const A=(0,s.Jt)((function(e){var t=e.children,r=(0,a.Z)(e,N),u=(0,l.useState)("submit"),m=(0,n.Z)(u,2),d=m[0],f=m[1],p=r.fields,v=r.defaults,b=r.endpoints,w=(0,c.s0)();return l.createElement(s.ZP,{endpoints:b,fields:p,defaults:v,onSubmitSucceed:function(){"submit"===d&&w((null==b?void 0:b.success)||"/")}},l.createElement("div",{className:"grid-view"},l.createElement(s._y.Consumer,null,t)),l.createElement(o.l0.Actions,null,l.createElement("div",null,l.createElement(o.zx,{isSubmit:!0,variant:"primary",onClick:function(){return f("submit")}},"Сохранить"),l.createElement(o.zx,{isSubmit:!0,variant:"default",onClick:function(){return f("apply")}},"Применить")),l.createElement(i.rU,{to:(null==b?void 0:b.success)||"/",className:"btn btn--default"},"Отменить")),l.createElement(P,null))}))},1394:(e,t,r)=>{r.d(t,{_y:()=>o,ZP:()=>w,Jt:()=>u.Z});var n=r(4942),a=r(7294),l=r(4184),i=r.n(l),c=r(3884);const o=a.createContext({fields:{}});var s=r(885),u=r(4393);function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const f=function(e){var t=(0,u.o)(),r=t.state,a=t.update,l=Object.entries(e).map((function(e){var t=(0,s.Z)(e,2),l=t[0],i=t[1],c=r.data[i.name],o={value:null==c?i.emptyValue||"":c,errors:r.errors[i.name],onChange:function(e){a(d(d({},r),{},{data:d(d({},r.data),{},(0,n.Z)({},i.name,e))}))}};return[l,d(d({},i),o)]}));return Object.fromEntries(l)};var p=r(6974);function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const w=function(e){var t=(0,a.useRef)(null),r=e.fields,n=e.defaults,l=void 0===n?{}:n,s=e.variant,m=e.endpoints,d=e.children,v=(0,u.o)(),w=function(e){var t=e.endpoints,r=e.onSubmit,n=e.onSubmitSucceed,a=(0,u.o)(),l=(0,p.s0)();return{submit:function(e){e.preventDefault(),"function"==typeof r?r(e):null!=t&&t.submit&&a.submit(t.submit,a.state.data).then((function(e){return"function"==typeof n?n(e):void l((null==t?void 0:t.success)||"/")})).catch((function(e){return e}))}}}(e);(0,a.useEffect)((function(){return v.update(b(b({},v.state),{},{data:l})),m&&m.request&&v.request(m.request),function(){return v.reset()}}),[]);var E=i()("form-view",s&&"form-view--".concat(s)),g="VALIDATION_FAILED"===v.state.status,y="SUBMIT_FAILED"===v.state.status,_="SUBMIT_SUCCEED"===v.state.status;return(0,a.useEffect)((function(){(y||_||g)&&t.current&&t.current.scrollIntoView({behavior:"smooth"})}),[_,y,g]),a.createElement(o.Provider,{value:{fields:f(r||{})}},a.createElement("div",{ref:t},a.createElement(c.bZ,{variant:"danger",isVisible:y},"Ошибка сохранения изменений. Пожалуйста, попробуйте позже."),a.createElement(c.bZ,{variant:"warning",isVisible:g},"Вероятно, некоторые поля формы заполнены неверно"),a.createElement(c.bZ,{variant:"success",isVisible:_},"Изменения успешно сохранены")),a.createElement("div",{className:E},a.createElement(c.l0,{onSubmit:w.submit},d)))}},7590:(e,t,r)=>{r.d(t,{Z:()=>c});var n=r(8081),a=r.n(n),l=r(3645),i=r.n(l)()(a());i.push([e.id,'@media(min-width: 1200px){.grid-view{display:grid;grid-template-columns:2fr 1fr;grid-template-rows:1fr;gap:0 2rem;grid-template-areas:". ."}.grid-view__columns{display:grid;grid-template-columns:1fr 1fr;grid-template-areas:". .";gap:0 2rem}}.tabs--t10n .tabs__nav{margin-bottom:0}.tabs--t10n .form__input--textarea{border-top:0;border-top-right-radius:0;border-top-left-radius:0}',""]);const c=i},4752:(e,t,r)=>{r.d(t,{Z:()=>c});var n=r(8081),a=r.n(n),l=r(3645),i=r.n(l)()(a());i.push([e.id,'@media(min-width: 1200px){.grid-view{display:grid;grid-template-columns:2fr 1fr;grid-template-rows:1fr;gap:0 2rem;grid-template-areas:". ."}.grid-view__columns{display:grid;grid-template-columns:1fr 1fr;grid-template-areas:". .";gap:0 2rem}}',""]);const c=i},4727:(e,t,r)=>{r.d(t,{Z:()=>c});var n=r(8081),a=r.n(n),l=r(3645),i=r.n(l)()(a());i.push([e.id,'.locale-view{background-color:rgba(253,126,20,.15);border-radius:2px;padding:1rem}.locale-view__switch{display:grid;grid-template-columns:1fr 1fr;grid-template-rows:1fr;gap:0 2rem;grid-template-areas:". ."}.locale-view__pane{display:none}.locale-view__pane--active{display:block}',""]);const c=i},3135:(e,t,r)=>{r.d(t,{Z:()=>c});var n=r(8081),a=r.n(n),l=r(3645),i=r.n(l)()(a());i.push([e.id,".workflow-view{display:flex;font-size:.875em;color:#343a40;margin-top:2rem}.workflow-view__item{display:flex}.workflow-view__item~.workflow-view__item{margin-left:2rem}.workflow-view__icon{color:#6c757d}.workflow-view__text{display:flex;flex-direction:column;margin-left:1rem}",""]);const c=i}}]);