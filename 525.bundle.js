"use strict";(self.webpackChunkadmin_rusiem_com=self.webpackChunkadmin_rusiem_com||[]).push([[525],{2195:(e,t,n)=>{n.d(t,{Z:()=>r});var l=n(7697);const r={title:{name:"title",label:"Название",hint:"Допускается не более 250 символов."},slug:{type:"slug",name:"slug",label:"Символьный код",hint:"Допускается не более 250 символов из набора [a-z0-9_]. Генерируется автоматически если значение не заполнено."},description:{name:"description",type:"textarea",label:"Аннотация",hint:"Допускается обычный текст и HTML код."},content:{name:"content",type:"textarea",label:"Основной текст",hint:"Допускается обычный текст и HTML код.",attrs:{size:"large"}},sort:{name:"sort",type:"number",label:"Индекс сортировки",hint:"Значение определяющее положение элемента в списке элементов."},publishedAt:{type:"datetime",name:"publishedAt",label:"Дата публикации",hint:"Дата, отображаемая пользователям на сайте."},isPublished:{type:"checkbox",name:"isPublished",label:"Опубликовать элемент?",hint:"Только опубликованные элементы видны пользователям."},sites:{type:"choices",name:"sites",label:"Отображать на сайтах",hint:"Выберите один или несколько сайтов, на которых элемент будет доступен.",attrs:{isMultiple:!0,choicesCallback:function(){return l.Z.lookup("/sites")}}},locale:{type:"choices",name:"locale",label:"Отображать для локали",hint:"Выберите локаль, для которой элемент будет отображаться на сайте.",attrs:{choicesCallback:function(){return l.Z.lookup("/locales")}}},tags:{type:"select",name:"tags",label:"Привязка к тегам",hint:"Выберите один или несколько тегов, которые будут присвоены элементу.",attrs:{isMultiple:!0,size:10,optionsCallback:function(){return l.Z.lookup("/catalog/tags/lookup?context=news")}}}}},5525:(e,t,n)=>{n.d(t,{Z:()=>ie});var l=n(7294),r=n(6974),a=n(8594),i=n(3884);const c=l.createContext({fields:{}});var o=n(4942);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const m=function(){var e=(0,l.useContext)(c).fields;return l.createElement(l.Fragment,null,l.createElement("div",{className:"grid-view__columns"},l.createElement(i.l0.Field,{field:e.publishedAt})),l.createElement(i.l0.Field,{field:e.title}),l.createElement(i.l0.Field,{field:u(u({},e.slug),{},{attrs:{value:e.title.value}})}),l.createElement("div",{className:"grid-view__columns"},l.createElement(i.l0.Field,{field:e.activeFrom}),l.createElement(i.l0.Field,{field:e.activeTo})),l.createElement(i.l0.Field,{field:e.template}))};var d=n(4586),f=n(2723),p=n(7390),b=n(8776);const v=l.createContext({});var w=n(7882);function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const y=function(e){var t=e.data,n=function(e){var t=(0,l.useContext)(v),n=t.toggleModal,r=t.toggleConfirm;return{update:function(){return n&&n(!0,{uuid:e&&e.uuid})},delete:function(){return r&&r(!0,{description:'Вы собираетесь удалить элемент "'.concat(e?e.translations.ru.title:"",'".'),endpoint:"remove"})}}}(t);return l.createElement(w.BK,{data:g(g({},t),{},{title:t.translations.ru.title}),baseUrl:"/forms/statuses"},(function(){return l.createElement(l.Fragment,null,l.createElement(i.vb.Button,{icon:"edit",onClick:n.update},"Изменить"),l.createElement(i.vb.Button,{icon:"copy",onClick:n.update},"Копировать"),l.createElement(i.vb.Divider,null),l.createElement(i.vb.Button,{icon:"trash-2",onClick:n.delete},"Удалить"))}))};var O={C:"Новый",A:"Утвержденный",R:"Отклоненный"};const h={columns:[{name:"title",title:"Название"},{name:"type",title:"Тип"},{name:"isDefault",title:"Умолч."},{name:"context",title:""}],templates:{row:function(e){var t=e.data;return l.createElement(l.Fragment,null,l.createElement("td",{className:"data-table__cell data-table__cell--title"},t.translations.ru.title),l.createElement("td",{className:"data-table__cell data-table__cell--type"},t.type?O[t.type]:"Unknown"),l.createElement("td",{className:"data-table__cell data-table__cell--isDefault"},t.isDefault?l.createElement(i.JO,{name:"check",variant:"success"}):l.createElement(i.JO,{name:"x",variant:"muted"})),l.createElement("td",{className:"data-table__cell data-table__cell--context"},l.createElement(y,{data:t})))},toolbar:function(e){var t=e.children,n=(0,r.UO)().form,a=void 0===n?"unknown":n;return l.createElement(w.Js,{createUrl:"/forms/".concat(a,"/statuses/create"),createLabel:"Добавить статус",withFilter:!1},t)}}};var _=n(3379),k=n.n(_),j=n(7795),P=n.n(j),Z=n(569),x=n.n(Z),D=n(3565),C=n.n(D),F=n(9216),S=n.n(F),N=n(4589),A=n.n(N),T=n(8145),z={};z.styleTagTransform=A(),z.setAttributes=C(),z.insert=x().bind(null,"head"),z.domAPI=P(),z.insertStyleElement=S(),k()(T.Z,z),T.Z&&T.Z.locals&&T.Z.locals;const M=(0,b.Z)((function(e){var t=e.data,n=e.toggleModal,r=h.columns,a=h.templates,c=function(){return n&&n(!0,{uuid:void 0})};return l.createElement(b._.Consumer,null,(function(e){return l.createElement(v.Provider,{value:{toggleModal:n,toggleConfirm:e.toggle}},l.createElement(i.wQ,{columns:r},0===t.length&&l.createElement(i.wQ.Empty,{span:r.length}),t.map((function(e){return l.createElement(i.wQ.Row,{key:(0,d.Z)(),template:l.createElement(a.row,{data:e})})}))),l.createElement("div",null,l.createElement(i.zx,{size:"small",onClick:c},"Добавить")))}))}),(0,p.Z)(f.Z));var U=n(885),B=n(4393);const I={name:"noviy-status",isDefault:!1,translations:{ru:{title:"Новый статус",locale:"ru"},en:{title:"New status",locale:"en"}}};var J=n(7697);const Q={name:{name:"name",label:"Символьный код",hint:"Допускается не более 250 символов из набора [a-z0-9_]."},type:{type:"select",name:"type",label:"Тип статуса",hint:"Выберите тип статуса",attrs:{placeholder:"- Не выбрано -",options:Object.entries(O).map((function(e){var t=(0,U.Z)(e,2);return{value:t[0],label:t[1]}}))}},template:{type:"select",name:"template",label:"Почтовый шаблон",hint:"Шаблон для автоматической отправки результата менеджеру сайта.",attrs:{placeholder:"- Не выбрано -",optionsCallback:function(){return J.Z.lookup("/mail/templates/lookup")}}},isDefault:{type:"checkbox",name:"isDefault",label:"По-умолчанию",hint:"Выберите, чтобы присваивать этот статус всем новым откликам на заявки по-умолчанию."},title:{name:"title",label:"Название статуса",hint:"Не более 250 символов."}};function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const K=(0,b.Z)((function(){var e=(0,B.o)().state.data;return l.createElement(b._.Consumer,null,(function(t){return l.createElement(M,{data:e.statuses,toggleModal:t.toggle})}))}),(function(e){var t=e.uuid,n=(0,l.useState)(I),r=(0,U.Z)(n,2),a=r[0],c=r[1],s=(0,B.o)().state.data.statuses,u=function(e,t){var n=Object.entries(Q).map((function(n){var l=(0,U.Z)(n,2),r=l[0],a=l[1],i=e[a.name],c={value:null==i?a.emptyValue||"":i,onChange:function(n){t(L(L({},e),{},(0,o.Z)({},a.name,n)))}};return[r,L(L({},a),c)]}));return Object.fromEntries(n)}(a,c),m=function(e){var t=(0,l.useContext)(b._).toggle,n=(0,B.o)(),r=n.state.data.statuses;return{submit:function(l){l.preventDefault();var a=r.findIndex((function(t){return t.uuid===e.uuid}));return a>-1?r[a]=e:r.push(e),n.update(R(R({},n.state),{},{data:R(R({},n.state.data),{},{statuses:r})})),t&&t(!1)},dismiss:function(e){return e.preventDefault(),t&&t(!1)}}}(a);return(0,l.useEffect)((function(){var e=s.findIndex((function(e){return e.uuid===t}));e>-1&&c(q(q({},a),s[e]))}),[t]),l.createElement(i.u_,{title:"Статус веб-формы"},l.createElement(i.l0.Field,{field:u.isDefault}),l.createElement(i.l0.Field,{field:u.name}),l.createElement("div",{className:"grid-view__columns"},l.createElement(i.l0.Field,{field:u.type}),l.createElement(i.l0.Field,{field:u.template})),l.createElement(i.l0.Actions,null,l.createElement(i.zx,{onClick:m.submit,variant:"primary"},"Подтвердить"),l.createElement(i.zx,{onClick:m.dismiss},"Отменить")))})),V=[{label:"Веб-форма",component:l.createElement(m,null)},{label:"Статусы",component:l.createElement(K,null)}],W=function(e){var t=e.fields;return l.createElement("div",{className:"grid-view__left-pane"},l.createElement(c.Provider,{value:{fields:t}},l.createElement(i.mQ,{items:V})))},Y=function(e){var t=e.fields;return l.createElement("div",{className:"grid-view__right-pane"},l.createElement(i.l0.Group,null,l.createElement(i.l0.Field,{field:t.isPublished})),l.createElement(i.l0.Group,null,l.createElement(i.l0.Field,{field:t.sites}),l.createElement(i.l0.Field,{field:t.context})))};var $=new Date,ee=new Date($.getTime()-60*$.getTimezoneOffset()*1e3).toISOString();const te={activeFrom:ee,activeTo:"",context:"default",slug:"novaya-forma",title:"Новая форма",isPublished:!0,publishedAt:ee,template:"",statuses:[]};var ne=n(2195),le={type:"select",name:"template",label:"Почтовый шаблон",hint:"Шаблон для автоматической отправки результата менеджеру сайта.",attrs:{placeholder:"- Выберите шаблон -",optionsCallback:function(){return J.Z.lookup("/mail/templates/lookup")}}},re={type:"select",name:"context",label:"Контекст",hint:"Привязка элемента к одному из контекстов.",attrs:{placeholder:"- Выберите контекст -",optionsCallback:function(){return J.Z.lookup("/context/lookup")}}};const ae={title:ne.Z.title,slug:ne.Z.slug,publishedAt:ne.Z.publishedAt,isPublished:ne.Z.isPublished,sites:ne.Z.sites,activeFrom:{type:"datetime",name:"activeFrom",label:"Дата начала активности",hint:"Дата, начиная с которой веб-форма доступна для заполнения."},activeTo:{type:"datetime",name:"activeTo",label:"Дата конца активности",hint:"Дата, до которой веб-форма доступна для заполнения. Значение должно быть больше, чем дата начала активности."},template:le,context:re},ie=function(e){var t=e.isNewElement,n=void 0!==t&&t,i=(0,r.UO)().uuid,c={request:i&&"GET:/forms/".concat(i),submit:n?"POST:/forms":i&&"PUT:/forms/".concat(i),success:"/forms"};return l.createElement(a.Z,{endpoints:c,fields:ae,defaults:te},(function(e){return l.createElement(l.Fragment,null,l.createElement(W,{fields:e.fields}),l.createElement(Y,{fields:e.fields}))}))}},8594:(e,t,n)=>{n.d(t,{Z:()=>F});var l=n(885),r=n(4925),a=n(7294),i=n(9711),c=n(6974),o=n(3884),s=n(1394),u=n(4393);const m=function(e){var t=e.workflow,n=e.defaults;return a.createElement(a.Fragment,null,a.createElement("span",null,"Создано ",t&&t.createdBy||(null==n?void 0:n.name)),a.createElement("span",null,t&&t.createdAt?a.createElement(o.ZX,{format:"datetime",value:t.createdAt}):null==n?void 0:n.date))},d=function(e){var t=e.workflow,n=e.defaults;return a.createElement(a.Fragment,null,a.createElement("span",null,"Изменено ",t&&t.updatedBy||(null==n?void 0:n.name)),a.createElement("span",null,t&&t.updatedAt?a.createElement(o.ZX,{format:"datetime",value:t.updatedAt}):null==n?void 0:n.date))};var f=n(3379),p=n.n(f),b=n(7795),v=n.n(b),w=n(569),E=n.n(w),g=n(3565),y=n.n(g),O=n(9216),h=n.n(O),_=n(4589),k=n.n(_),j=n(3135),P={};P.styleTagTransform=k(),P.setAttributes=y(),P.insert=E().bind(null,"head"),P.domAPI=v(),P.insertStyleElement=h(),p()(j.Z,P),j.Z&&j.Z.locals&&j.Z.locals;const Z=function(){var e=(0,u.o)().state.data.workflow,t={name:"Джон Смит",date:"Дата неизвестна"};return a.createElement("div",{className:"workflow-view"},a.createElement("div",{className:"workflow-view__item workflow-view__item--created"},a.createElement("div",{className:"workflow-view__icon"},a.createElement(o.JO,{name:"clock"})),a.createElement("div",{className:"workflow-view__text"},a.createElement(m,{workflow:e,defaults:t}))),a.createElement("div",{className:"workflow-view__item workflow-view__item--updated"},a.createElement("div",{className:"workflow-view__icon"},a.createElement(o.JO,{name:"clock"})),a.createElement("div",{className:"workflow-view__text"},a.createElement(d,{workflow:e,defaults:t}))))};var x=n(4752),D={};D.styleTagTransform=k(),D.setAttributes=y(),D.insert=E().bind(null,"head"),D.domAPI=v(),D.insertStyleElement=h(),p()(x.Z,D),x.Z&&x.Z.locals&&x.Z.locals;var C=["children"];const F=(0,s.Jt)((function(e){var t=e.children,n=(0,r.Z)(e,C),u=(0,a.useState)("submit"),m=(0,l.Z)(u,2),d=m[0],f=m[1],p=n.fields,b=n.defaults,v=n.endpoints,w=(0,c.s0)();return a.createElement(s.ZP,{endpoints:v,fields:p,defaults:b,onSubmitSucceed:function(){"submit"===d&&w((null==v?void 0:v.success)||"/")}},a.createElement("div",{className:"grid-view"},a.createElement(s._y.Consumer,null,t)),a.createElement(o.l0.Actions,null,a.createElement("div",null,a.createElement(o.zx,{isSubmit:!0,variant:"primary",onClick:function(){return f("submit")}},"Сохранить"),a.createElement(o.zx,{isSubmit:!0,variant:"default",onClick:function(){return f("apply")}},"Применить")),a.createElement(i.rU,{to:(null==v?void 0:v.success)||"/",className:"btn btn--default"},"Отменить")),a.createElement(Z,null))}))},8145:(e,t,n)=>{n.d(t,{Z:()=>c});var l=n(8081),r=n.n(l),a=n(3645),i=n.n(a)()(r());i.push([e.id,".data-table__col--isDefault{width:6.375rem}.data-table__col--type{width:11.375rem}.data-table__cell--isDefault{text-align:center}.data-table__header--isDefault{text-align:center}",""]);const c=i},4752:(e,t,n)=>{n.d(t,{Z:()=>c});var l=n(8081),r=n.n(l),a=n(3645),i=n.n(a)()(r());i.push([e.id,'@media(min-width: 1200px){.grid-view{display:grid;grid-template-columns:2fr 1fr;grid-template-rows:1fr;gap:0 2rem;grid-template-areas:". ."}.grid-view__columns{display:grid;grid-template-columns:1fr 1fr;grid-template-areas:". .";gap:0 2rem}}',""]);const c=i},3135:(e,t,n)=>{n.d(t,{Z:()=>c});var l=n(8081),r=n.n(l),a=n(3645),i=n.n(a)()(r());i.push([e.id,".workflow-view{display:flex;font-size:.875em;color:#343a40;margin-top:2rem}.workflow-view__item{display:flex}.workflow-view__item~.workflow-view__item{margin-left:2rem}.workflow-view__icon{color:#6c757d}.workflow-view__text{display:flex;flex-direction:column;margin-left:1rem}",""]);const c=i}}]);